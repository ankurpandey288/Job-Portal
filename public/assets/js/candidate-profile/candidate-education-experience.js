(()=>{"use strict";$(document).ready((function(){$("#countryId,#educationCountryId, #editCountry,#editEducationCountry").select2({width:"100%"}),$("#editState, #editEducationState").select2({width:"100%"}),$("#editCity,#editEducationCity").select2({width:"100%"}),$("#degreeLevelId").select2({width:"100%"}),$(".addExperienceBtn").on("click",(function(){showAddExperienceDiv()})),$(".addEducationBtn").on("click",(function(){showAddEducationDiv()})),$("#btnEducationCancel").on("click",(function(){$("#degreeLevelId").val(""),$("#degreeLevelId").select2({width:"100%",placeholder:"Select Degree Level"}),hideAddEducationDiv()})),$("#btnEditEducationCancel").on("click",(function(){hideEditEducationDiv()})),$("#btnCancel").on("click",(function(){hideAddExperienceDiv()})),$("#btnEditCancel").on("click",(function(){hideEditExperienceDiv()})),window.setDatePicker=function(e,t){$(e).datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD",useCurrent:!0,sideBySide:!0,maxDate:new moment})),$(t).datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD",sideBySide:!0,maxDate:new moment,useCurrent:!1}))},$("#startDate").on("dp.change",(function(e){$("#endDate").val(""),$("#endDate").data("DateTimePicker").minDate(e.date)})),$("#editStartDate").on("dp.change",(function(e){setTimeout((function(){$("#editEndDate").data("DateTimePicker").minDate(e.date)}),1e3)})),$("#default").on("click",(function(){1==$(this).prop("checked")?($("#endDate").prop("disabled",!0),$("#endDate").val(""),$("#endDate").val("").removeAttr("required",!1),$("#requiredText").addClass("d-none")):0==$(this).prop("checked")&&($("#endDate").val("").attr("required",!0),$("#requiredText").removeClass("d-none"),$("#endDate").data("DateTimePicker").minDate($("#startDate").val()),$("#endDate").prop("disabled",!1))})),$("#editWorking").on("click",(function(){1==$(this).prop("checked")?($("#editEndDate").prop("disabled",!0),$("#editEndDate").val(""),$("#editEndDate").val("").removeAttr("required",!1),$("#editRequiredText").addClass("d-none")):0==$(this).prop("checked")&&($("#editEndDate").val("").attr("required",!0),$("#editRequiredText").removeClass("d-none"),$("#editEndDate").data("DateTimePicker").minDate($("#editStartDate").val()),$("#editEndDate").prop("disabled",!1))})),$(document).on("submit","#addNewExperienceForm",(function(e){e.preventDefault(),processingBtn("#addNewExperienceForm","#btnExperienceSave","loading"),$.ajax({url:addExperienceUrl,type:"POST",data:$(this).serialize(),success:function(e){e.success&&($("#notfoundExperience").addClass("d-none"),displaySuccessMessage(e.message),hideAddExperienceDiv(),renderExperienceTemplate(e.data),randerCVTemplate())},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#addNewExperienceForm","#btnExperienceSave")}})})),$(document).on("click",".edit-experience",(function(e){var t=$(e.currentTarget).data("id");renderExperienceData(t)})),$(document).on("submit","#editExperienceForm",(function(e){e.preventDefault(),processingBtn("#editExperienceForm","#btnEditExperienceSave","loading");var t=$("#experienceId").val();$.ajax({url:experienceUrl+t,type:"put",data:$(this).serialize(),success:function(e){e.success&&(displaySuccessMessage(e.message),hideEditExperienceDiv(),$(".candidate-experience-container").children(".candidate-experience").each((function(){$(this).attr("data-id")==e.data.id&&$(this).remove()})),renderExperienceTemplate(e.data.candidateExperience),randerCVTemplate())},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#editExperienceForm","#btnEditExperienceSave")}})})),$(document).on("click",".delete-experience",(function(e){var t=$(e.currentTarget).data("id");deleteItem(experienceUrl+t,"Experience",".candidate-experience-container",".candidate-experience","#notfoundExperience")})),$(document).on("submit","#addNewEducationForm",(function(e){e.preventDefault(),processingBtn("#addNewEducationForm","#btnEducationSave","loading"),$.ajax({url:addEducationUrl,type:"POST",data:$(this).serialize(),success:function(e){e.success&&(displaySuccessMessage(e.message),renderEducationTemplate(e.data),$("#candidateEducationsDiv").show(),$("#createEducationsDiv").addClass("d-none"),randerCVTemplate())},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#addNewEducationForm","#btnEducationSave")}})})),$(document).on("click",".edit-education",(function(e){var t=$(e.currentTarget).data("id");renderEducationData(t)})),$(document).on("submit","#editEducationForm",(function(e){e.preventDefault(),processingBtn("#editEducationForm","#btnEditEducationSave","loading");var t=$("#educationId").val();$.ajax({url:educationUrl+t,type:"put",data:$(this).serialize(),success:function(e){e.success&&(displaySuccessMessage(e.message),hideEditEducationDiv(),$(".candidate-education-container").children(".candidate-education").each((function(){$(this).attr("data-id")==e.data.id&&$(this).remove()})),renderEducationTemplate(e.data.candidateEducation),randerCVTemplate())},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#editEducationForm","#btnEditEducationSave")}})})),$(document).on("click",".delete-education",(function(e){var t=$(e.currentTarget).data("id");deleteItem(educationUrl+t,Lang.get("messages.candidate_profile.education"),".candidate-education-container",".candidate-education","#notfoundEducation")})),window.deleteItem=function(e,t,i,d,a){swal({title:Lang.get("messages.common.delete")+" !",text:Lang.get("messages.common.are_you_sure_want_to_delete")+'"'+t+'" ?',type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#6777ef",cancelButtonColor:"#d33",cancelButtonText:Lang.get("messages.common.no"),confirmButtonText:Lang.get("messages.common.yes")},(function(){!function(e,t,i,d,a){$.ajax({url:e,type:"DELETE",dataType:"json",success:function(e){e.success&&($(i).children(d).each((function(){$(this).attr("data-id")==e.data&&$(this).remove()})),$(i).children(d).length<=0&&$(a).removeClass("d-none"),randerCVTemplate()),swal({title:Lang.get("messages.common.deleted")+" !",text:t+Lang.get("messages.common.has_been_deleted"),type:"success",confirmButtonColor:"#6777ef",timer:2e3})},error:function(e){swal({title:"",text:e.responseJSON.message,type:"error",confirmButtonColor:"#6777ef",timer:5e3})}})}(e,t,i,d,a)}))},$("#countryId, #educationCountryId, #editCountry, #editEducationCountry").on("change",(function(e,t){var i=$(this).data("modal-type"),d=void 0!==$(this).data("is-edit");$.ajax({url:companyStateUrl,type:"get",dataType:"json",data:{postal:$(this).val()},success:function(e){$("experience"===i?d?"#editState":"#stateId":d?"#editEducationState":"#educationStateId").empty(),$("experience"===i?d?"#editState":"#stateId":d?"#editEducationState":"#educationStateId").append('<option value="" selected>Select State</option>'),$.each(e.data,(function(e,t){$("experience"===i?d?"#editState":"#stateId":d?"#editEducationState":"#educationStateId").append($("<option></option>").attr("value",e).text(t))})),d&&$("experience"===i?"#editState":"#editEducationState").val(t.stateId).trigger("change",[{cityId:t.cityId}])}})})),$("#stateId, #educationStateId, #editState, #editEducationState").on("change",(function(e,t){var i=$(this).data("modal-type"),d=void 0!==$(this).data("is-edit");$.ajax({url:companyCityUrl,type:"get",dataType:"json",data:{state:$(this).val(),country:$("experience"===i?d?"#editCountry":"#countryId":d?"#editEducationCountry":"#educationCountryId").val()},success:function(e){$("experience"===i?d?"#editCity":"#cityId":d?"#editEducationCity":"#educationCityId").empty(),$("experience"===i?d?"#editCity":"#cityId":d?"#editEducationCity":"#educationCityId").append('<option value="" selected>Select City</option>'),$.each(e.data,(function(e,t){$("experience"===i?d?"#editCity":"#cityId":d?"#editEducationCity":"#educationCityId").append($("<option></option>").attr("value",e).text(t))})),d&&$("experience"===i?"#editCity":"#editEducationCity").val(void 0!==t?t.cityId:"").trigger("change.select2")}})}))})),window.showAddEducationDiv=function(){hideAddExperienceDiv(),hideEditExperienceDiv(),hideAddOnlineProfileDiv(),hideAddGeneralDiv(),$("#candidateEducationsDiv").hide(),$("#createEducationsDiv").removeClass("d-none"),resetModalForm("#addNewEducationForm","#validationErrorsBox"),$("#educationCountryId, #educationStateId, #educationCityId").val(""),$("#educationStateId, #educationCityId").empty(),$("#educationStateId").select2({width:"100%",placeholder:"Select State"}),$("#educationCityId").select2({width:"100%",placeholder:"Select City"}),$("#educationCountryId").trigger("change.select2")},window.showEditEducationDiv=function(){hideAddExperienceDiv(),hideEditExperienceDiv(),hideAddOnlineProfileDiv(),hideAddGeneralDiv(),$("#candidateEducationsDiv").hide(),$("#editEducationsDiv").removeClass("d-none"),resetModalForm("#editEducationForm","#editValidationErrorsBox"),$("#editEducationCountry, #editEducationState, #editEducationCity").val(""),$("#editEducationState, #editEducationCity").empty(),$("#editEducationCountry").trigger("change.select2")},window.hideAddEducationDiv=function(){$("#candidateEducationsDiv").show(),$("#createEducationsDiv").addClass("d-none")},window.hideEditEducationDiv=function(){$("#candidateEducationsDiv").show(),$("#editEducationsDiv").addClass("d-none")},window.showAddExperienceDiv=function(){hideAddEducationDiv(),hideEditEducationDiv(),hideAddOnlineProfileDiv(),hideAddGeneralDiv(),$("#candidateExperienceDiv").hide(),$("#createExperienceDiv").removeClass("d-none"),setDatePicker("#startDate","#endDate"),resetModalForm("#addNewExperienceForm","#validationErrorsBox"),$("#countryId, #stateId, #cityId").val(""),$("#stateId, #cityId").empty(),$("#stateId").select2({width:"100%",placeholder:"Select State"}),$("#cityId").select2({width:"100%",placeholder:"Select City"}),$("#countryId").trigger("change.select2")},window.showEditExperienceDiv=function(){hideAddEducationDiv(),hideEditEducationDiv(),hideAddOnlineProfileDiv(),hideAddGeneralDiv(),$("#candidateExperienceDiv").hide(),$("#editExperienceDiv").removeClass("d-none"),resetModalForm("#editExperienceForm","#editValidationErrorsBox"),setDatePicker("#editStartDate","#editEndDate"),$("#editExperienceCountry, #editExperienceState, #editExperienceCity").val(""),$("#editExperienceState, #editExperienceCity").empty(),$("#editExperienceCountry").trigger("change.select2")},window.hideAddExperienceDiv=function(){$("#candidateExperienceDiv").show(),$("#createExperienceDiv").addClass("d-none")},window.hideEditExperienceDiv=function(){$("#candidateExperienceDiv").show(),$("#editExperienceDiv").addClass("d-none")},window.renderEducationData=function(e){showEditEducationDiv(),startLoader(),$("#btnEditEducationSave").attr("disabled",!0),$.ajax({url:candidateUrl+e+"/edit-education",type:"GET",success:function(e){e.success&&(stopLoader(),$("#educationId").val(e.data.id),$("#editDegreeLevel").val(e.data.degree_level.id).trigger("change"),$("#editDegreeTitle").val(e.data.degree_title),$("#editEducationCountry").val(e.data.country_id).trigger("change",[{stateId:e.data.state_id,cityId:e.data.city_id}]),$("#editInstitute").val(e.data.institute),$("#editResult").val(e.data.result),$("#editYear").val(e.data.year).trigger("change"),$("#btnEditEducationSave").attr("disabled",!1))},error:function(e){stopLoader(),displayErrorMessage(e.responseJSON.message)}})},window.renderEducationTemplate=function(e){var t=null!=$(".candidate-education-container .candidate-education:last").data("education-id")?$(".candidate-education-container .candidate-education:last").data("experience-id")+1:0,i=$.templates("#CVcandidateEducationTemplate"),d={candidateEducationNumber:t,id:e.id,degreeLevel:e.degree_level.name,degreeTitle:e.degree_title,year:e.year,country:e.country,institute:e.institute},a=i.render(d);$(".candidate-education-container").append(a),$("#notfoundEducation").addClass("d-none")},window.renderExperienceData=function(e){showEditExperienceDiv(),startLoader(),$("#btnEditCancel").attr("disabled",!0),$.ajax({url:candidateUrl+e+"/edit-experience",type:"GET",success:function(e){e.success&&(stopLoader(),$("#experienceId").val(e.data.id),$("#editTitle").val(e.data.experience_title),$("#editCompany").val(e.data.company),$("#editCountry").val(e.data.country_id).trigger("change",[{stateId:e.data.state_id,cityId:e.data.city_id}]),$("#editStartDate").val(moment(e.data.start_date).format("YYYY-MM-DD")),$("#editDescription").val(e.data.description),1==e.data.currently_working?($("#editWorking").prop("checked",!0),$("#editEndDate").val("")):($("#editWorking").prop("checked",!1),$("#editEndDate").val(moment(e.data.end_date).format("YYYY-MM-DD")),$("#editRequiredText").removeClass("d-none")),1==e.data.currently_working&&$("#editEndDate").prop("disabled",!0),$("#btnEditCancel").attr("disabled",!1))},error:function(e){stopLoader(),displayErrorMessage(e.responseJSON.message)}})},window.renderExperienceTemplate=function(e){var t=null!=$(".candidate-experience-container .candidate-experience:last").data("experience-id")?$(".candidate-experience-container .candidate-experience:last").data("experience-id")+1:0,i=$.templates("#CVcandidateExperienceTemplate"),d=1==e.currently_working?present:moment(e.end_date,"YYYY-MM-DD").format("Do MMM, YYYY"),a={candidateExperienceNumber:t,id:e.id,title:e.experience_title,company:e.company,startDate:moment(e.start_date,"YYYY-MM-DD").format("Do MMM, YYYY"),endDate:d,description:e.description,country:e.country},n=i.render(a);$(".candidate-experience-container").append(n),$("#notfoundExperience").addClass("d-none")}})();