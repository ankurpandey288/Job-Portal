(()=>{"use strict";$(document).ready((function(){$("#filterStatus").select2()}));var e="#jobApplicationsTbl";$(e).DataTable({processing:!0,serverSide:!0,order:[[0,"asc"]],ajax:{url:jobApplicationsUrl,type:"GET",data:function(e){e.status=$("#filterStatus").find("option:selected").val()}},columnDefs:[{targets:[0],className:"text-center",width:"15%"},{targets:[2],className:"text-right",width:"15%"},{targets:[3],className:"text-center",width:"13%",orderable:!1},{targets:[4],className:"text-center",width:"13%"},{targets:[5],className:"text-center",width:"15%",orderable:!1},{targets:[6],className:"text-center",width:"12%",orderable:!1}],columns:[{data:function(e){return'<a href="'+(candidateDetailsUrl+"/"+e.candidate.unique_id)+'">'+e.candidate.user.full_name+"</a>"},name:"candidate.user.first_name"},{data:function(e){return e.job.currency.currency_icon+"&nbsp;"+currency(e.expected_salary).format()},name:"expected_salary"},{data:function(e){return moment(e.created_at,"YYYY-MM-DD").format("Do MMM, YYYY")},name:"created_at"},{data:function(e){return e.hasResumeAvailable?"N/A":'<a href="'+(downloadDocumentUrl+"/"+e.id)+'">Download</a>'},name:"candidate.user.last_name"},{data:function(e){return isEmpty(e.job_stage_id)?'<i class="font-20 fas fa-times-circle text-danger"></i>':e.job_stage.name},name:"jobStage.name"},{data:function(e){return'<span class="badge badge-'+{0:"warning",1:"primary",2:"danger",3:"info",4:"success"}[e.status]+'">'+statusArray[e.status]+"</span>"},name:"status"},{data:function(e){console.log(e);var t=!1;(new Date).toISOString().split("T")[0]>e.job.job_expiry_date&&(t=!0);var a=jobApplicationsUrl+"/"+e.id+"/slots",n=!1,o=!1,s=!1,c=!1,i=!1;1==e.status&&(i=!0),2==e.status&&(c=!0),3==e.status&&(n=!0),4==e.status&&(o=!0),isEmpty(e.job_stage_id)||(s=!0);var r=[{statusId:e.status,id:e.id,isApplied:i,isCompleted:n,isShortlisted:o,isJobStage:s,isRejected:c,viewSlotsScreen:a,isJobExpiry:t}];return prepareTemplateRender("#jobApplicationActionTemplate",r)},name:"id"}],fnInitComplete:function(){$("#filterStatus").change((function(){$("#jobApplicationsTbl").DataTable().ajax.reload(null,!0)}))}}),$(document).on("click",".action-delete",(function(t){var a=$(t.currentTarget).data("id");deleteItem(jobApplicationDeleteUrl+"/"+a,e,Lang.get("messages.job_application.job_application"))})),$(document).on("click",".short-list",(function(e){var t=$(e.currentTarget).data("id");changeStatus(t,4)})),$(document).on("click",".action-completed",(function(e){var t=$(e.currentTarget).data("id");selectedItem(t,3)})),$(document).on("click",".action-decline",(function(e){var t=$(e.currentTarget).data("id");rejectedItem(t,2)})),window.changeStatus=function(t,a){$.ajax({url:jobApplicationStatusUrl+t+"/status/"+a,method:"get",cache:!1,success:function(t){t.success&&$(e).DataTable().ajax.reload(null,!1)},error:function(e){displayErrorMessage(e.responseJSON.message)}})},window.rejectedItem=function(e,t){swal({title:Lang.get("messages.common.rejected")+" !",text:Lang.get("messages.common.are_you_sure_want_to_reject")+'"'+Lang.get("messages.job_application.job_application")+'" ?',type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#6777ef",cancelButtonColor:"#d33",cancelButtonText:Lang.get("messages.common.no"),confirmButtonText:Lang.get("messages.common.yes")},(function(){changeStatus(e,t),swal({title:Lang.get("messages.common.rejected")+" !",text:Lang.get("messages.job_application.job_application")+" "+Lang.get("messages.common.has_been_rejected"),type:"success",confirmButtonColor:"#6777ef",timer:2e3})}))},window.selectedItem=function(e,t){swal({title:Lang.get("messages.common.selected")+" !",text:Lang.get("messages.common.are_you_sure_want_to_select")+'"'+Lang.get("messages.job_application.job_application")+'" ?',type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#6777ef",cancelButtonColor:"#d33",cancelButtonText:Lang.get("messages.common.no"),confirmButtonText:Lang.get("messages.common.yes")},(function(){changeStatus(e,t),swal({title:Lang.get("messages.common.selected")+" !",text:Lang.get("messages.job_application.job_application")+" "+Lang.get("messages.common.has_been_selected"),type:"success",confirmButtonColor:"#6777ef",timer:2e3})}))},$(document).on("click",".change-job-stage",(function(){var e=$(this).data("id");$("#jobApplicationId").val(e),$("#changeJobStageModal").appendTo("body").modal("show")})),$(document).on("submit","#changeJobStageForm",(function(t){t.preventDefault(),processingBtn("#changeJobStageForm","#changeJobStageBtnSave","loading"),$.ajax({url:changeJobStage,type:"POST",data:$(this).serialize(),success:function(t){t.success&&(displaySuccessMessage(t.message),$("#changeJobStageModal").modal("hide"),$(e).DataTable().ajax.reload(null,!1))},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){processingBtn("#changeJobStageForm","#changeJobStageBtnSave")}})})),$("#changeJobStageModal").on("hidden.bs.modal",(function(){$("#jobStageId").val("").trigger("change")})),$(document).ready((function(){$("#jobStageId").select2({width:"100%"})}))})();